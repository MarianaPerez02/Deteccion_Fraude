{% extends "base.html" %}

{% block title %}Comparación de Modelos{% endblock %}

{% block content %}
<div class="row mb-2">
    <div class="col-12">
        <h1 class="mb-2">
            <i class="fas fa-chart-bar"></i> Comparación de Modelos
        </h1>
    </div>
</div>

<!-- Tabla de Comparación -->
{% if models %}
<div class="row mb-2">
    <div class="col-12">
        <div class="card">
            <div class="card-header bg-primary text-white">
                <h5 class="mb-0"><i class="fas fa-table"></i> Tabla Comparativa de Métricas</h5>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-striped table-hover">
                        <thead class="table-dark">
                            <tr>
                                <th>Modelo</th>
                                <th>Precisión</th>
                                <th>Recall</th>
                                <th>F1-Score</th>
                                <th>ROC-AUC</th>
                                <th>Mejor Métrica</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for model in models %}
                            <tr>
                                <td><strong>{{ model.model }}</strong></td>
                                <td>
                                    {% if model.precision %}
                                    <span class="badge bg-info">{{ "%.4f"|format(model.precision) }}</span>
                                    {% else %}N/A{% endif %}
                                </td>
                                <td>
                                    {% if model.recall %}
                                    <span class="badge bg-success">{{ "%.4f"|format(model.recall) }}</span>
                                    {% else %}N/A{% endif %}
                                </td>
                                <td>
                                    {% if model.f1_score %}
                                    <span class="badge bg-warning text-dark">{{ "%.4f"|format(model.f1_score) }}</span>
                                    {% else %}N/A{% endif %}
                                </td>
                                <td>
                                    {% if model.roc_auc %}
                                    <span class="badge bg-primary">{{ "%.4f"|format(model.roc_auc) }}</span>
                                    {% else %}N/A{% endif %}
                                </td>
                                <td>
                                    {% if model.is_best %}
                                    <i class="fas fa-trophy text-warning"></i> Mejor
                                    {% endif %}
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
{% endif %}

<!-- Gráficos -->
<div class="row mb-2">
    {% if graph_metrics %}
    <div class="col-md-6">
        <div class="card">
            <div class="card-header bg-primary text-white">
                <h5 class="mb-0"><i class="fas fa-chart-column"></i> Métricas por Modelo</h5>
            </div>
            <div class="card-body">
                <div id="graph-metrics"></div>
            </div>
        </div>
    </div>
    {% endif %}

    {% if graph_roc %}
    <div class="col-md-6">
        <div class="card">
            <div class="card-header bg-success text-white">
                <h5 class="mb-0"><i class="fas fa-chart-line"></i> Curvas ROC</h5>
            </div>
            <div class="card-body">
                <div id="graph-roc"></div>
            </div>
        </div>
    </div>
    {% endif %}
</div>

{% endblock %}

{% block extra_js %}
{% if graph_metrics %}
<script>
    var metricsData = {{ graph_metrics | safe }};
    Plotly.newPlot('graph-metrics', metricsData.data, metricsData.layout);
</script>
{% endif %}

{% if graph_roc %}
<script>
    var rocData = {{ graph_roc | safe }};
    Plotly.newPlot('graph-roc', rocData.data, rocData.layout);
</script>
{% endif %}
{% endblock %}
